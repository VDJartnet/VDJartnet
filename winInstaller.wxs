<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Name="VDJartnet" Manufacturer="VDJartnet" Id="d557b374-3b60-457a-b6e0-9c3b12e0aa96" UpgradeCode="73a9d409-7478-4a43-914b-603c16a3cd7c" Language="1033" Codepage="1252" Version="0.2.2"> <!--Replace version with autogenerated-->

    <Package Id="*" Keywords="Installer" Description="VDJartnet Installer" Comments="VDJartnet is distributed under the GPLv3 licence" Manufacturer="VDJartnet" InstallerVersion="100" Languages="1033" Compressed="yes" SummaryCodepage="1252" />

	<Media Id="1" Cabinet="Sample.cab" EmbedCab="yes" />
	
    <Property Id="VDJINSTALLED_PROGRAMFILES">
      <DirectorySearch Id="VirtualDJProgram" Path="C:\Program Files\VirtualDJ\" Depth="0" />
    </Property>

    <Property Id="VDJINSTALLED_PROGRAMFILES_X86">
      <DirectorySearch Id="VirtualDJProgram" Path="C:\Program Files (x86)\VirtualDJ\" Depth="0" />
    </Property>

    <Condition Message="VirtualDJ must be installed to use VDJartnet.">
      <![CDATA[Installed OR VDJINSTALLED_PROGRAMFILES OR VDJINSTALLED_PROGRAMFILES_X86]]>
    </Condition>
	
	<Property Id="ALLUSERS" Secure="yes"/>

	<Condition Message="VDJartnet can only be installed on a per-user basis.">
      <![CDATA[NOT ALLUSERS]]>
    </Condition>
	
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="PersonalFolder" Name="Documents">
        <Directory Id="VirtualDJ" Name="VirtualDJ">
          <Directory Id="Plugins" Name="Plugins">
            <Directory Id="AutoStart" Name="AutoStart">

              <Component Id="VDJartnet.dll" Guid="542e0393-7ed1-4d90-b3ea-eea2a6dac2af">
                <RemoveFolder Id="VirtualDJRemove" Directory="VirtualDJ" On="uninstall" />
                <RemoveFolder Id="PluginsRemove" Directory="Plugins" On="uninstall" />
                <RemoveFolder Id="AutoStartRemove" Directory="AutoStart" On="uninstall" />
			    <RegistryValue Root="HKCU" Key="Software\VDJartnet\VDJartnet" Type="string" Name="VDJartnet" Value="VDJartnet" KeyPath="yes" />
                <File Id="VDJartnet.dll" Name="VDJartnet.dll" Source="VDJartnet.dll" Vital="yes" />
              </Component>

              <Directory Id="VDJartnet" Name="VDJartnet">

                <Component Id="config.txt" Guid="cdb51818-5d0a-43f9-b66d-2136734aca9d">
                  <RemoveFolder Id="VDJartnetRemoveConfig" On="uninstall" />
			      <RegistryValue Root="HKCU" Key="Software\VDJartnet\configtxt" Type="string" Name="configtxt" Value="configtxt" KeyPath="yes" />
                  <File Id="config.txt" Name="config.txt" Source="$(env.TEMP)\config.txt" Vital="no" />
                </Component>

                <Component Id="presets.txt" Guid="338f7bde-1f30-438e-90d2-08412c63b081">
                  <RemoveFolder Id="VDJartnetRemovePresets" On="uninstall" />
			      <RegistryValue Root="HKCU" Key="Software\VDJartnet\presetstxt" Type="string" Name="presetstxt" Value="presetstxt" KeyPath="yes" />
                  <File Id="presets.txt" Name="presets.txt" Source="$(env.TEMP)\presets.txt" Vital="no" />
                </Component>

              </Directory>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
    </Directory>

    <Property Id="CONFIGEXISTS">
      <DirectorySearch Id="VDJartnetSearchConfig" Path="[VDJartnet]" Depth="0">
        <FileSearch Name="config.txt" />
      </DirectorySearch>
    </Property>

    <Property Id="PRESETSEXISTS">
      <DirectorySearch Id="VDJartnetSearchPresets" Path="[VDJartnet]" Depth="0">
        <FileSearch Name="presets.txt" />
      </DirectorySearch>
    </Property>

    <Feature Id="VDJartnet.dll" Title="VDJartnet" Description="Install VDJartnet" Level="1" Absent="disallow">
      <ComponentRef Id="VDJartnet.dll" />
    </Feature>

    <Feature Id="config.txt" Title="config.txt" Description="Install updated config.txt" Level="1" Absent="allow">
      <ComponentRef Id="config.txt" />
      <Condition Level="0">
        CONFIGEXISTS
      </Condition>
    </Feature>

    <Feature Id="presets.txt" Title="presets.txt" Description="Install updated presets.txt" Level="1" Absent="allow">
      <ComponentRef Id="presets.txt" />
      <Condition Level="0">
        PRESETSEXISTS
      </Condition>
    </Feature>

    <WixVariable Id="WixUIReadmeRtf" Value="README.rtf" />
    <WixVariable Id="WixUILicenseRtf" Value="COPYING" />

    <!--<UI Id="MyWixUI_Mondo">-->
      <UIRef Id="WixUI_FeatureTree" />
      <UIRef Id="WixUI_ErrorProgressText" />
<!--
      <DialogRef Id="ReadmeDlg" />

      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="ReadmeDlg">NOT Installed</Publish>
      <Publish Dialog="LicenseAgreementDlg" Control="Back" Event="NewDialog" Value="ReadmeDlg">1</Publish>
    </UI>
-->
  </Product>
</Wix>
